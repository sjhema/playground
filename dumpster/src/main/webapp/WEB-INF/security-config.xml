<!-- <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-4.0.xsd">

	<security:global-method-security jsr250-annotations="enabled" />

	Define how the security filters should be applied on the incoming urls 
    <bean id="springSecurityFilterChain" class="org.springframework.security.web.FilterChainProxy">
		<security:filter-chain-map request-matcher="ant">
			<security:filter-chain pattern="/login/*" filters="none"/>
			<security:filter-chain pattern="/**" filters="httpSessionContextFilter, "/>
		</security:filter-chain-map>
	</bean>
    <constructor-arg>
        <bean class="org.springframework.security.web.DefaultSecurityFilterChain">
		    <security:filter-chain pattern="/login/*" filters="none"/>
			<security:filter-chain pattern="/**" 
				filters="httpSessionContextFilter,
						logoutFilter,
						authenticationProcessingFilter,
						exceptionTranslationFilter,
						filterSecurityInterceptor" />
			</bean>
	</constructor-arg>
	
	</bean>
	
	<bean id="httpSessionContextFilter" class="org.springframework.security.web.context.HttpSessionSecurityContextRepository"/> 
	
	<bean id="logoutFilter" class="org.springframework.security.web.authentication.logout.LogoutFilter">
		<constructor-arg ref="logoutSuccessHandler" /> 
		<constructor-arg>   
			<list>     
				<bean class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler" />	 
			</list> 
		</constructor-arg>   
	</bean>
	
	<bean id="exceptionTranslationFilter" class="org.springframework.security.web.access.ExceptionTranslationFilter">
		<constructor-arg name="authenticationEntryPoint" ref="authenticationEntryPoint"/>
		<constructor-arg name="accessDeniedHandler" ref="accessDeniedHandler" />
	</bean>

	<bean id="authenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint" >
		<constructor-arg name="loginFormUrl" value="/login/login.do" />
	</bean>
	<bean id="accessDeniedHandler" class="org.springframework.security.web.access.AccessDeniedHandlerImpl">
		<property name="errorPage" value="/login/unauthorized.do"/>
	</bean>
	<bean id="authenticationProcessingFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
		<property name="authenticationManager" ref="authenticationManager" />
		<property name="authenticationSuccessHandler">
			<bean class="com.trans.core.AuthenticationSuccessHandler">  
	             <property name="defaultTargetUrl" value="/home/home.do" />  
         	</bean>
		</property>
		<property name="authenticationFailureHandler" ref="authenticationFailureHandler"/>
	</bean>

	<bean id="authenticationManager" class="org.springframework.security.authentication.ProviderManager">
		<constructor-arg>
	        <list>
	            <ref bean="authenticationProvider" />
	        </list>
	    </constructor-arg>
	</bean>
	
	<bean id="authenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
	<constructor-arg>
			<user-service>
				<user name="sjhema" password="sjhemaO" authorities="user" />
				<user name="raghav" password="raghav" authorities="user,admin" />
				<user name="bharat" password="bharat" authorities="user,admin" />
			</user-service>
	</constructor-arg>
	</bean>
	
	
	
	<bean id="filterSecurityInterceptor" class="org.springframework.security.web.access.intercept.FilterSecurityInterceptor">
		<property name="authenticationManager" ref="authenticationManager"/>
		<property name="accessDecisionManager" ref="accessDecisionManager"/>
		<property name="securityMetadataSource" ref="customSecureResourceFilter"/>
	</bean>
    <bean id="customSecureResourceFilter" class="com.trans.core.CustomSecureResourceFilter">
		<property name="ignoreUrls" value="/login/*"/> 
	</bean>
	<bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased">
		<constructor-arg name="decisionVoters">
		<list>
			<bean class="org.springframework.security.access.vote.RoleVoter" />
			<bean class="org.springframework.security.access.vote.AuthenticatedVoter" />
		</list>
		</constructor-arg>
	</bean>
    <bean id="authenticationFailureHandler" class="com.trans.core.AuthenticationFailureHandler"  >
        <constructor-arg value="/dumpster/login.do"/>
    </bean>
    
    <bean id="logoutSuccessHandler" class="com.trans.core.LogoutSuccessHandler"  /> 
</beans> -->